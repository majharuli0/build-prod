import{W as x,z as E,u as k,s as v,r as d,X as U,Y as h,Z as u,j as i,_ as c,$ as j,a0 as I,q as a,a1 as P}from"./index-BJvb-Z7V.js";try{let o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new o.Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="04c7260f-39f9-44f6-9ae9-100f0be60252",o._sentryDebugIdIdentifier="sentry-dbid-04c7260f-39f9-44f6-9ae9-100f0be60252")}catch{}function L(){const o=x();E();const t=k(),{setStoreRole:_,setUser:m}=v(),[y,T]=d.useState(!0),n=o.id.split("-"),f=()=>{const e=a.get("user"),r=P();a.get("rootToken")||(a.set("rootToken",r),a.set("rootRole",e==null?void 0:e.role))},p=e=>j(e),w=e=>{const r={super_admin:"/support-agent/dashboard/",supports_agent:"/supporter/support-agent/dashboard",nurse:"/supporter/nurse/dashboard",end_user:"/supporter/end-user/dashboard",elderly:`/supporter/elderlies/elderly-profile/${n[1]}?tab=overview`};t(r[e]||"/support-nurnt/dashboard")},g=e=>{a.set("user",e),a.set("mainRole",e.role),a.set("role",e.role),_({role:e.role}),m({role:e.role}),setTimeout(()=>{T(!1),w(e.sub_role||e.role)},800)},b=d.useCallback(async()=>{var e;try{const r=await U({id:n[0]});if(!((e=r==null?void 0:r.data)!=null&&e.role))throw new Error("Invalid role");if(n.length>=2){const s=await h({id:n[0],params:{role:r.data.role==="nursing_home"?"nurse":"supports_agent"}});s.data.role=="end_user"&&(s==null?void 0:s.session_code)==0?(u.custom(l=>i.jsx(c,{t:l,title:"Error",text:"This user does not have an active subscription."})),t(-1)):(f(),p(s.data.access_token),g({...s.data,sub_role:"elderly"}))}else{const s=await h({id:n[0]});s.data.role=="end_user"&&(s==null?void 0:s.session_code)==0?(u.custom(l=>i.jsx(c,{t:l,title:"Error",text:"Subscription Expired!"})),t(-1)):(f(),p(s.data.access_token),g(r.data))}}catch(r){console.error("Error fetching user profile:",r),u.custom(s=>i.jsx(c,{t:s,title:"Error",text:r.response.data.message})),t(-1)}},[o.id]);if(d.useEffect(()=>{b()},[b]),y)return i.jsx(I,{loaderTitle:"Loading User Profile"})}export{L as default};
//# sourceMappingURL=index-CDKcnFDk.js.map
