import{r as n,S as W,u as Y,a9 as $,aa as F,bI as H,g as R,j as e,aZ as O,c0 as U,c1 as P,c2 as v,c3 as z,c4 as G,af as J,bK as K,by as Q,bx as Z,F as q,aW as X,p as B,c5 as D,o as ee}from"./index-BvrCmaJw.js";import{C as V}from"./Collapse-ChIR1pX-.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},g=new t.Error().stack;g&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[g]="5b5edf04-d7a0-4c0d-913e-5f1bcb9a80e0",t._sentryDebugIdIdentifier="sentry-dbid-5b5edf04-d7a0-4c0d-913e-5f1bcb9a80e0")}catch{}function ie({refreshAlertList:t,isElderlyVisible:g=!1,isAlarmViewBtn:p=!1}){const{setModalDataList:N,modalDataList:M}=n.useContext(W),[a,m]=n.useState(!1),[c,h]=n.useState(null),[i,b]=n.useState([]),f=["Critical"],w=Y(),{notificationEvent:r}=$(),j=n.useRef(0),u=n.useCallback(async()=>{let s=[],x=30;for(const A of f){if(x<=0)break;const S=H(A);if(S)try{const _=(await F({to_date:"2024-11-30",from_date:R().format("YYYY-MM-DD"),is_resolved:!1,limit:x,...S})).data||[];if(s=[...s,..._],x-=_.length,x<=0)break}catch(y){console.error(`Error fetching ${A} alerts:`,y)}}s.length>j.current&&t(),j.current=s.length,b(s)},[]);n.useEffect(()=>{u()},[u]);const I={dots:i.length>=2,infinite:i.length>2,speed:500,slidesToShow:i.length===1?1:2,slidesToScroll:1,draggable:!0,arrows:!1,appendDots:s=>e.jsx("div",{style:{backgroundColor:"transparent",borderRadius:"10px",padding:"2px"},children:e.jsx("ul",{id:"dots",style:{margin:"0px"},children:s})}),responsive:[{breakpoint:1200,settings:{slidesToShow:(i.length===1,1),slidesToScroll:1}},{breakpoint:800,settings:{slidesToShow:1,slidesToScroll:1}}]},C=s=>{window.scrollTo(0,0),w(`/supporter/elderlies/elderly-profile/${s.elderly_id}?tab=overview`)};return n.useEffect(()=>{r&&u()},[r]),e.jsxs(e.Fragment,{children:[i.length>0&&e.jsx("div",{id:"ActiveAlertsCards",className:"w-full mb-2 transition-all duration-300",children:e.jsx(O,{...I,className:"w-full transition-all duration-300",children:i.map((s,x)=>{var A,S,y,_,L,E;return e.jsx("div",{className:"px-2 overflow-hidden transition-all duration-300 relative w-full",children:e.jsxs("div",{id:"alertItem",className:`rounded-2xl overflow-hidden w-full ${((A=v(s))==null?void 0:A.label)==="Critical"?"bg-red-500":((S=v(s))==null?void 0:S.label)==="Warning"?"bg-yellow-500":"bg-blue-500"} p-4 w-full flex justify-between items-center`,children:[e.jsx("div",{id:"leftSide",className:"z-50",children:e.jsx("div",{id:"alertItemHeader",children:e.jsxs("div",{id:"alertItemTitleAndDescription",className:"flex flex-col gap-6",children:[e.jsxs("div",{id:"time",className:"flex gap-2",children:[g&&e.jsxs("span",{onClick:()=>C(s),className:"bg-white font-semibold p-1 px-2 pl-1 rounded-full text-text-primary flex items-center gap-2 cursor-pointer hover:opacity-90",children:[e.jsx(U,{size:22,style:{opacity:"0.8"}}),s==null?void 0:s.elderly_name]}),e.jsxs("span",{className:"bg-white font-semibold p-1 px-2 rounded-full text-text-primary flex items-center gap-2",children:[e.jsx("div",{id:"dot",className:`w-2 h-2 ${((y=v(s))==null?void 0:y.label)==="Critical"?"bg-red-500":((_=v(s))==null?void 0:_.label)==="Warning"?"bg-yellow-500":"bg-blue-500"} rounded-full animate-ping`}),P(s.created_at)]}),e.jsx("span",{className:"bg-white font-semibold p-1 px-2 rounded-full text-text-primary",children:e.jsx(z,{date:s.created_at})})]}),e.jsxs("div",{id:"alertItemTitleAndDescription",children:[e.jsx("h1",{className:"text-xl font-bold text-white m-0",children:(L=v(s))==null?void 0:L.title}),e.jsx("p",{className:"text-white text-base m-0 leading-none",children:(E=v(s))==null?void 0:E.message})]})]})})}),p?e.jsx("div",{id:"btn",className:"z-50 w-fit",children:e.jsx("span",{onClick:()=>{h(s),w("/support-nurnt/dashboard/alarm-detail",{state:{alertData:s,id:s==null?void 0:s.elderly_id}})},className:"text-sm p-2 px-3 bg-white rounded-xl text-text-primary cursor-pointer hover:bg-white/90 transition-all duration-300 text-nowrap",children:"View Alert"})}):e.jsx("div",{id:"rightSide",className:"z-50 w-fit",children:e.jsx("span",{onClick:()=>{h(s),m(!0)},className:"text-sm p-2 px-3 bg-white rounded-xl text-text-primary cursor-pointer hover:bg-white/90 transition-all duration-300 text-nowrap",children:"Mark as Complete"})}),e.jsx("img",{src:G,alt:"",className:"absolute top-0 right-0"})]})},x)})})}),e.jsx(J,{openAlertCloseModal:a,setOpenAlertCloseModal:m,selectedAlert:c,getAlertListDatas:()=>{u(),t()}})]})}function te({data:t={}}){var c,h,i,b,f,w,r,j;const g=Y(),[p,N]=n.useState(null);n.useRef(null),n.useRef(!1);const[M,a]=n.useState(!1),m=u=>{switch(u){case"Info":return"bg-blue-500";case"Critical":return"bg-red-500";case"Warning":return"bg-yellow-500";default:return"bg-blue-500"}};return e.jsxs("div",{className:"w-full flex flex-col gap-4 p-4 pr-0 h-full pt-0",children:[e.jsxs("div",{id:"roomAlertHeader",className:`alert-header !h-[75px] flex justify-between items-center relative px-4 overflow-hidden rounded-lg ${m((c=v(t))==null?void 0:c.label)}`,children:[e.jsx("div",{className:"loader"}),e.jsxs("div",{className:"text-container flex flex-col gap-0 h-full justify-center text-white",children:[e.jsx("p",{className:"text-sm text-gray-100 m-0 font-medium",children:t.room_name}),e.jsx("h2",{className:"text-lg font-bold m-0 leading-none ",children:(h=v(t))==null?void 0:h.title})]}),e.jsx("span",{onClick:()=>{g(`/supporter/elderlies/elderly-profile/${t==null?void 0:t.elderly_id}`)},className:"text-sm text-gray-100 cursor-pointer p-3 py-2 bg-white/0 rounded-lg hover:bg-white/10 transition-all duration-300",children:"View Elderly"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-0 border-b border-gray-200 pb-2 ",children:[e.jsx("h2",{className:"text-lg font-bold m-0 leading-none",children:t.elderly_name}),e.jsx("p",{className:"text-sm text-gray-500 m-0",children:t.address})]}),e.jsx("div",{})]}),e.jsxs("div",{id:"roomMapAndDetails",className:"flex gap-4 h-full overflow-hidden",children:[e.jsx(K,{deviceId:(i=t==null?void 0:t.rooms)==null?void 0:i.device_no,children:e.jsxs("div",{className:"map-container w-2/3 border overflow-hidden h-full",children:[((b=t==null?void 0:t.rooms)==null?void 0:b.mount_type)===1&&((f=t==null?void 0:t.rooms)==null?void 0:f.is_device_bind)&&e.jsx(Q,{roomInfo:t==null?void 0:t.rooms}),((w=t==null?void 0:t.rooms)==null?void 0:w.mount_type)===2&&((r=t==null?void 0:t.rooms)==null?void 0:r.is_device_bind)&&e.jsx(Z,{roomInfo:t==null?void 0:t.rooms}),!((j=t==null?void 0:t.rooms)!=null&&j.is_device_bind)&&e.jsx("span",{className:"w-full h-full flex items-center justify-center",children:e.jsx("p",{children:" No Device Data Available"})})]})}),e.jsxs("div",{className:"details-container w-1/3 ",children:[e.jsxs("div",{className:"flex flex-col gap-0 p-3",children:[e.jsx("h2",{className:"text-xl font-bold m-0 leading-none",children:P(t.created_at)}),e.jsx("p",{className:"text-sm text-gray-500 m-0 font-medium",children:"Time of Incident"})]}),e.jsxs("div",{className:"flex flex-col gap-0 p-3",children:[e.jsx("h2",{className:"text-xl font-bold m-0 leading-none",children:e.jsx(z,{date:t.created_at})}),e.jsx("p",{className:"text-sm text-gray-500 m-0 font-medium",children:"Alert Life"})]})]})]})]})}const{Panel:se}=V;function re(){const{setModalDataList:t,modalDataList:g}=n.useContext(W),{notificationEvent:p}=$(),[N,M]=n.useState("All"),[a,m]=n.useState([]),[c,h]=n.useState(null),[i,b]=n.useState(null),[f,w]=n.useState(null),[r,j]=n.useState(!1),[u,I]=n.useState(1),[C,s]=n.useState(!0),x=n.useRef(null),A=n.useCallback(()=>{!C||r||(j(!0),F({to_date:"2024-11-30",from_date:R().format("YYYY-MM-DD"),is_resolved:!1,limit:20,show_device_area:1,show_device_boundaries:1,page:u,...f}).then(l=>{m(d=>[...d,...l.data]),u>=l.totalPages&&s(!1),j(!1)}).catch(l=>{console.error(l),j(!1)}))},[f,u,C,r]);n.useEffect(()=>{A()},[u,f]),n.useEffect(()=>{if(a.length>0&&!c){const l=a[0];h(l._id),b(l)}},[a,c]);const S=l=>{h(l);const d=a.find(o=>o._id===l);b(d)},y=n.useCallback(q(()=>{if(!x.current||r||!C)return;const{scrollTop:l,scrollHeight:d,clientHeight:o}=x.current;l+o>=d-50&&I(T=>T+1)},200),[r,C]),_=l=>{w(H(l)),I(1),m([]),s(!0)};n.useEffect(()=>{p&&A()},[p]),n.useEffect(()=>{const l=x.current;return l&&l.addEventListener("scroll",y),()=>{l&&l.removeEventListener("scroll",y)}},[y]);const L=n.useMemo(()=>a.reduce((l,d)=>{const o=d.room_name;return l[o]||(l[o]=[]),l[o].push(d),l},{}),[a]),E=l=>{switch(l){case"Critical":return"red";case"Warning":return"orange";case"Info":return"blue";default:return"gray"}};return e.jsxs("div",{className:"w-full flex justify-center items-center h-[495px] overflow-hidden",children:[e.jsxs("div",{className:"w-[30%] flex flex-col gap-4 h-full",children:[e.jsx(X,{style:{width:"100%"},block:!0,options:le,onChange:l=>_(l)}),e.jsxs("div",{ref:x,className:"w-full overflow-auto",style:{height:"440px"},children:[a.length===0&&!r&&e.jsx(B,{description:"No active alerts available"}),a.length>0&&e.jsx(V,{children:Object.entries(L).map(([l,d])=>([...new Set(d.map(o=>{var T;return(T=v(o))==null?void 0:T.label}))],e.jsx(se,{header:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("span",{className:"text-black font-semibold",children:l})}),children:d&&d.map(o=>{var T;return e.jsxs("div",{onClick:()=>S(o._id),className:`flex justify-between items-center p-2 cursor-pointer rounded-md px-4 ${c===o._id?"bg-gray-100":""}`,children:[e.jsx("span",{className:"text-[14px] font-semibold",children:R(o.created_at).format("hh:mm:ss a")}),e.jsx(D,{color:E((T=v(o))==null?void 0:T.label),size:"large"})]},o._id)})},l)))}),r&&e.jsx("div",{className:"w-full flex justify-center py-4",children:e.jsx(ee,{})}),!C&&a.length>0&&e.jsx("div",{className:"w-full text-center py-4 text-gray-500",children:"No more alerts to load"})]})]}),e.jsx("div",{className:"w-[70%] h-full",children:i?e.jsx(te,{data:i}):e.jsx(B,{description:"Select an alert to view details"})})]})}const le=[{label:"All",value:"All"},{label:"Critical",value:"Critical"},{label:"Warning",value:"Warning"},{label:"Info",value:"Info"}],k=t=>{const g=["Critical","Info","Warning"],p=["Living Room","Kitchen","Bedroom","Bathroom"],N=["John Doe","Jane Doe","Alice Smith","Bob Johnson","Emma Brown","Michael Wilson","Sarah Davis","David Miller","Lisa Garcia","James Rodriguez"],M=["Fall Detected","Fire Detected","Inactivity Alert","Medication Reminder","Unusual Behavior","High Temperature","Low Temperature","Water Leak","Door Left Open","Window Broken"],a=["Medication Taken","Medication Not Taken","Medication Reminder"],m=["Wheelchair","Crutches","Cane","None"],c=["Yes","No"],h=["Yes","No"],i=["Yes","No"],b=["1","4","2","No"],f=["True","False"];return Array.from({length:t},(w,r)=>({_id:r+1,alertType:g[Math.floor(Math.random()*g.length)],elderlyName:N[Math.floor(Math.random()*N.length)],alertName:M[Math.floor(Math.random()*M.length)],roomId:String(r+1),roomName:p[Math.floor(Math.random()*p.length)],alertLifetime:`${Math.floor(Math.random()*10)}m ${Math.floor(Math.random()*60)}s`,time:new Date().toLocaleString(),alertDescription:`${M[Math.floor(Math.random()*M.length)]} in the ${p[Math.floor(Math.random()*p.length)]}`,status:"Active",isAlert:f[Math.floor(Math.random()*f.length)],address:"123 Main St, Anytown, USA",coordinates:{latitude:37.7749+(Math.random()-.5)*.01,longitude:-122.4194+(Math.random()-.5)*.01},closedAt:new Date().toLocaleString(),closedBy:N[Math.floor(Math.random()*N.length)],eventName:a[Math.floor(Math.random()*a.length)],disabilityType:m[Math.floor(Math.random()*m.length)],additionalInfo:"This is additional info for event",hospital:{name:"Hospital For Special Surgery",phone:"1234567890",latitude:-33.8743612,longitude:151.2261153},allergies:c[Math.floor(Math.random()*c.length)],diseases:h[Math.floor(Math.random()*h.length)],medications:i[Math.floor(Math.random()*i.length)],activeAlert:b[Math.floor(Math.random()*b.length)],alertComments:"This is alert comments",alertLifespan:[{dateTime:"24-01-2024 10:00 AM",description:"At 10:00 AM, the alert was created"},{dateTime:"24-01-2024 10:30 AM",description:"Agent (petar) clicked on the incident in 10:30 (30mins later)"},{dateTime:"24-01-2024 10:32 AM",description:"Agent (petar) clicked on “Call Elderly” in 10:32 (2mins later)"},{dateTime:"24-01-2024 10:34 AM",description:"Agent (petar) clicked on “Call 911” in 10:34 (2mins later)"},{dateTime:"24-01-2024 10:36 AM",description:"Agent (petar) clicked on “Close Alert” in 10:36 (2mins later)"}]}))};k(14);k(20);k(20);k(20);k(20);export{ie as A,re as R};
//# sourceMappingURL=mock-CaQFKJiH.js.map
